# å°é¼ è¡Œä¸ºç›‘æµ‹ç³»ç»Ÿ - è¯¦ç»†æ‰§è¡Œæ­¥éª¤

## âœ… å·²å®Œæˆæ­¥éª¤ï¼ˆåç«¯ç¯å¢ƒæ­å»ºï¼‰

### âœ… æ­¥éª¤1: Dockerç¯å¢ƒéªŒè¯ - å·²å®Œæˆ
- Docker Desktopè¿è¡Œæ­£å¸¸
- Dockerç½‘ç»œ `docker_mouse-network` å·²åˆ›å»º
- åŸºç¡€å‘½ä»¤æµ‹è¯•é€šè¿‡

### âœ… æ­¥éª¤2: MySQLæ•°æ®åº“æœåŠ¡ - å·²å®Œæˆ
- MySQL 8.0å®¹å™¨å¯åŠ¨æˆåŠŸ
- æ•°æ®åº“ `mouse_behavior` å·²åˆ›å»º
- RuoYiæ¡†æ¶æ•°æ®è¡¨å·²å¯¼å…¥ï¼ˆ25ä¸ªè¡¨ï¼‰
- æ•°æ®åº“è¿æ¥æµ‹è¯•é€šè¿‡

### âœ… æ­¥éª¤3: RuoYiåç«¯æœåŠ¡ - å·²å®Œæˆ
- é¡¹ç›®ç¼–è¯‘æˆåŠŸ
- åç«¯æœåŠ¡å¯åŠ¨æˆåŠŸ
- æœåŠ¡è®¿é—®åœ°å€ï¼šhttp://localhost:8092
- æ•°æ®åº“è¿æ¥é…ç½®æ­£ç¡®

### âœ… æ­¥éª¤4: è‡ªåŠ¨åŒ–è„šæœ¬å·¥å…· - å·²å®Œæˆ
- å¿«é€Ÿå¯åŠ¨è„šæœ¬ï¼š`scripts/quick-start.ps1`
- ç¯å¢ƒæ£€æŸ¥è„šæœ¬ï¼š`scripts/check-environment.ps1`
- æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬ï¼š`scripts/init-database.ps1`
- è„šæœ¬ä½¿ç”¨æ–‡æ¡£ï¼š`scripts/README.md`

## ğŸš€ å¿«é€Ÿä½¿ç”¨æ–¹æ³•ï¼ˆæ¨èï¼‰

### ä¸€é”®å¯åŠ¨æ•´ä¸ªåç«¯ç¯å¢ƒ
```powershell
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
.\scripts\quick-start.ps1
```

### ç¯å¢ƒæ£€æŸ¥å’Œè¯Šæ–­
```powershell
# æ£€æŸ¥Dockerç¯å¢ƒã€ç½‘ç»œã€å®¹å™¨çŠ¶æ€
.\scripts\check-environment.ps1
```

### æ‰‹åŠ¨æ“ä½œï¼ˆé«˜çº§ç”¨æˆ·ï¼‰
```powershell
# ä»…å¯åŠ¨MySQL
cd docker
docker-compose up -d mysql

# ç¼–è¯‘é¡¹ç›®
docker run --rm -v "${PWD}:/app" -w /app maven:3.8.4-openjdk-17 mvn clean package -DskipTests

# å¯åŠ¨åç«¯æœåŠ¡
docker run --rm -v "${PWD}:/app" -w /app -p 8092:80 --network docker_mouse-network maven:3.8.4-openjdk-17 java -jar ruoyi-admin/target/ruoyi-admin.jar
```

### æ­¥éª¤4: åˆ›å»ºæ•°æ®åº“è¡¨ç»“æ„
```sql
-- è¿æ¥åˆ°MySQLåæ‰§è¡Œä»¥ä¸‹SQL
USE mouse_behavior;

-- ç”¨æˆ·è¡¨
CREATE TABLE t_user (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    username VARCHAR(50) NOT NULL UNIQUE,
    password VARCHAR(100) NOT NULL,
    email VARCHAR(100),
    phone VARCHAR(20),
    real_name VARCHAR(50),
    role_id BIGINT,
    status TINYINT DEFAULT 1,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_username (username),
    INDEX idx_status (status)
);

-- è®¾å¤‡è¡¨
CREATE TABLE t_device (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    device_id VARCHAR(50) NOT NULL UNIQUE,
    device_name VARCHAR(100) NOT NULL,
    device_type VARCHAR(20) DEFAULT 'camera',
    location VARCHAR(100),
    ip_address VARCHAR(15),
    mac_address VARCHAR(17),
    api_key VARCHAR(100),
    status TINYINT DEFAULT 1,
    last_heartbeat DATETIME,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_device_id (device_id),
    INDEX idx_status (status)
);

-- å®éªŒé¡¹ç›®è¡¨
CREATE TABLE t_experiment (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    experiment_name VARCHAR(100) NOT NULL,
    experiment_code VARCHAR(50) NOT NULL UNIQUE,
    description TEXT,
    researcher_id BIGINT,
    start_time DATETIME,
    end_time DATETIME,
    status TINYINT DEFAULT 1,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_experiment_code (experiment_code),
    INDEX idx_researcher_id (researcher_id)
);

-- å°é¼ è¡¨
CREATE TABLE t_mouse (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    mouse_id VARCHAR(50) NOT NULL UNIQUE,
    mouse_name VARCHAR(50),
    species VARCHAR(50),
    strain VARCHAR(50),
    gender ENUM('male', 'female'),
    birth_date DATE,
    weight DECIMAL(5,2),
    cage_id BIGINT,
    experiment_id BIGINT,
    status TINYINT DEFAULT 1,
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    update_time DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    INDEX idx_mouse_id (mouse_id),
    INDEX idx_cage_id (cage_id),
    INDEX idx_experiment_id (experiment_id)
);

-- è¡Œä¸ºæ•°æ®è¡¨
CREATE TABLE t_behavior_data (
    id BIGINT PRIMARY KEY AUTO_INCREMENT,
    device_id VARCHAR(50) NOT NULL,
    mouse_id VARCHAR(50),
    experiment_id BIGINT,
    behavior_type VARCHAR(50),
    behavior_value JSON,
    confidence DECIMAL(3,2),
    timestamp DATETIME NOT NULL,
    video_file VARCHAR(200),
    create_time DATETIME DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_device_timestamp (device_id, timestamp),
    INDEX idx_mouse_timestamp (mouse_id, timestamp),
    INDEX idx_experiment_timestamp (experiment_id, timestamp)
);

-- æ’å…¥æµ‹è¯•æ•°æ®
INSERT INTO t_user (username, password, email, real_name, role_id) VALUES
('admin', '$2a$10$7JB720yubVSOfvVMe6/YqO4wkhWGEn67XVb1Q0K1EFyLWY1uIHe1a', 'admin@mouse.com', 'ç³»ç»Ÿç®¡ç†å‘˜', 1),
('researcher1', '$2a$10$7JB720yubVSOfvVMe6/YqO4wkhWGEn67XVb1Q0K1EFyLWY1uIHe1a', 'researcher1@mouse.com', 'ç ”ç©¶å‘˜1', 2);

INSERT INTO t_device (device_id, device_name, location, api_key) VALUES
('CAM001', '1å·æ‘„åƒå¤´', 'å®éªŒå®¤A-1å·ç¬¼', 'test-api-key-001'),
('CAM002', '2å·æ‘„åƒå¤´', 'å®éªŒå®¤A-2å·ç¬¼', 'test-api-key-002');

INSERT INTO t_experiment (experiment_name, experiment_code, description, researcher_id) VALUES
('å°é¼ è¡Œä¸ºåŸºçº¿æµ‹è¯•', 'EXP001', 'å»ºç«‹å°é¼ æ­£å¸¸è¡Œä¸ºåŸºçº¿æ•°æ®', 2),
('è¯ç‰©Aæ•ˆæœè¯„ä¼°', 'EXP002', 'æµ‹è¯•è¯ç‰©Aå¯¹å°é¼ è¡Œä¸ºçš„å½±å“', 2);
```

## ğŸ“¥ ä¸‹è½½å’Œé…ç½®RuoYiæ¡†æ¶

### æ­¥éª¤5: ä¸‹è½½RuoYi-Vue-Plus
```powershell
# åˆ›å»ºåç«¯é¡¹ç›®ç›®å½•
mkdir d:\mouse\backend
cd d:\mouse\backend

# å…‹éš†RuoYi-Vue-Plusé¡¹ç›®
git clone https://github.com/dromara/RuoYi-Vue-Plus.git .

# æˆ–è€…ä¸‹è½½ZIPåŒ…
# è®¿é—®: https://github.com/dromara/RuoYi-Vue-Plus
# ç‚¹å‡» Code -> Download ZIP
# è§£å‹åˆ° d:\mouse\backend ç›®å½•
```

### æ­¥éª¤6: é…ç½®RuoYié¡¹ç›®
```powershell
# è¿›å…¥é¡¹ç›®ç›®å½•
cd d:\mouse\backend

# ä¿®æ”¹æ•°æ®åº“é…ç½®æ–‡ä»¶
# ç¼–è¾‘ ruoyi-admin/src/main/resources/application-dev.yml
```

**application-dev.yml é…ç½®å†…å®¹**:
```yaml
# æ•°æ®æºé…ç½®
spring:
  datasource:
    type: com.alibaba.druid.pool.DruidDataSource
    driverClassName: com.mysql.cj.jdbc.Driver
    druid:
      # ä¸»åº“æ•°æ®æº
      master:
        url: jdbc:mysql://localhost:3306/mouse_behavior?useUnicode=true&characterEncoding=utf8&zeroDateTimeBehavior=convertToNull&useSSL=true&serverTimezone=GMT%2B8
        username: mouse_user
        password: mouse_pass
      # ä»åº“æ•°æ®æºï¼ˆå¯é€‰ï¼‰
      slave:
        enabled: false
  
  # Redisé…ç½®
  redis:
    host: localhost
    port: 6379
    password:
    database: 0
    timeout: 10s
    lettuce:
      pool:
        min-idle: 0
        max-idle: 8
        max-active: 8
        max-wait: -1ms
```

### æ­¥éª¤7: ç¼–è¯‘å’Œè¿è¡ŒRuoYi
```powershell
# ç¡®ä¿å·²å®‰è£…Mavenå’ŒJDK 17
java -version
mvn -version

# ç¼–è¯‘é¡¹ç›®
mvn clean install -DskipTests

# è¿è¡Œåç«¯æœåŠ¡
cd ruoyi-admin
mvn spring-boot:run

# æˆ–è€…è¿è¡ŒjaråŒ…
java -jar target/ruoyi-admin.jar
```

### æ­¥éª¤8: éªŒè¯RuoYiè¿è¡Œ
```powershell
# æ£€æŸ¥æœåŠ¡æ˜¯å¦å¯åŠ¨
# æµè§ˆå™¨è®¿é—®: http://localhost:8080
# æŸ¥çœ‹Swaggeræ–‡æ¡£: http://localhost:8080/doc.html

# æµ‹è¯•APIæ¥å£
curl http://localhost:8080/actuator/health
```

## ğŸ”§ è‡ªå®šä¹‰å¼€å‘

### æ­¥éª¤9: åˆ›å»ºå°é¼ ç›‘æµ‹ç›¸å…³æ¨¡å—
```powershell
# åœ¨ruoyi-admin/src/main/java/com/ruoyi/web/controllerä¸‹åˆ›å»º
# mouseåŒ…ï¼Œç”¨äºå°é¼ ç›¸å…³æ§åˆ¶å™¨

# åˆ›å»ºä»¥ä¸‹ç›®å½•ç»“æ„:
# com.ruoyi.mouse.controller  - æ§åˆ¶å™¨
# com.ruoyi.mouse.service     - æœåŠ¡å±‚
# com.ruoyi.mouse.domain      - å®ä½“ç±»
# com.ruoyi.mouse.mapper      - æ•°æ®è®¿é—®å±‚
```

### æ­¥éª¤10: åˆ›å»ºè®¾å¤‡ç®¡ç†æ¨¡å—
**Deviceå®ä½“ç±»** (com/ruoyi/mouse/domain/Device.java):
```java
package com.ruoyi.mouse.domain;

import com.baomidou.mybatisplus.annotation.*;
import com.ruoyi.common.core.domain.BaseEntity;
import lombok.Data;
import lombok.EqualsAndHashCode;

import java.time.LocalDateTime;

@Data
@EqualsAndHashCode(callSuper = true)
@TableName("t_device")
public class Device extends BaseEntity {
    
    @TableId(value = "id", type = IdType.AUTO)
    private Long id;
    
    @TableField("device_id")
    private String deviceId;
    
    @TableField("device_name")
    private String deviceName;
    
    @TableField("device_type")
    private String deviceType;
    
    @TableField("location")
    private String location;
    
    @TableField("ip_address")
    private String ipAddress;
    
    @TableField("mac_address")
    private String macAddress;
    
    @TableField("api_key")
    private String apiKey;
    
    @TableField("status")
    private Integer status;
    
    @TableField("last_heartbeat")
    private LocalDateTime lastHeartbeat;
}
```

### æ­¥éª¤11: æµ‹è¯•è‡ªå®šä¹‰æ¨¡å—
```powershell
# é‡æ–°ç¼–è¯‘é¡¹ç›®
mvn clean compile

# é‡å¯æœåŠ¡
# Ctrl+C åœæ­¢å½“å‰æœåŠ¡
mvn spring-boot:run

# æµ‹è¯•æ–°å¢çš„APIæ¥å£
curl -X GET http://localhost:8080/mouse/device/list
```

## ğŸ“Š ç›‘æ§å’ŒéªŒè¯

### æ­¥éª¤12: æ£€æŸ¥ç³»ç»ŸçŠ¶æ€
```powershell
# æ£€æŸ¥Dockerå®¹å™¨çŠ¶æ€
docker-compose ps

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -ano | findstr :3306
netstat -ano | findstr :6379
netstat -ano | findstr :8080

# æ£€æŸ¥ç³»ç»Ÿèµ„æº
docker stats
```

### æ­¥éª¤13: åˆ›å»ºæµ‹è¯•è„šæœ¬
```powershell
# åˆ›å»ºAPIæµ‹è¯•è„šæœ¬
# test-api.ps1

$baseUrl = "http://localhost:8080"

# æµ‹è¯•å¥åº·æ£€æŸ¥
Invoke-RestMethod -Uri "$baseUrl/actuator/health" -Method GET

# æµ‹è¯•è®¾å¤‡åˆ—è¡¨API
Invoke-RestMethod -Uri "$baseUrl/mouse/device/list" -Method GET

# æµ‹è¯•ç™»å½•API
$loginData = @{
    username = "admin"
    password = "admin123"
}
Invoke-RestMethod -Uri "$baseUrl/login" -Method POST -Body ($loginData | ConvertTo-Json) -ContentType "application/json"
```

## ğŸ¯ ä»Šæ—¥ç›®æ ‡æ£€æŸ¥æ¸…å•

- [x] âœ… DockeræœåŠ¡æ­£å¸¸è¿è¡Œ
- [x] âœ… MySQLæ•°æ®åº“å¯åŠ¨å¹¶å¯è¿æ¥
- [x] âœ… Redisç¼“å­˜æœåŠ¡æ­£å¸¸
- [x] âœ… MinIOå¯¹è±¡å­˜å‚¨å¯è®¿é—®
- [x] âœ… æ•°æ®åº“è¡¨ç»“æ„åˆ›å»ºå®Œæˆ
- [x] âœ… æµ‹è¯•æ•°æ®æ’å…¥æˆåŠŸ
- [x] âœ… RuoYiæ¡†æ¶ä¸‹è½½å®Œæˆ
- [x] âœ… RuoYié¡¹ç›®é…ç½®æ­£ç¡®
- [ ] âš ï¸ **éœ€è¦å®‰è£…Java/Mavenç¯å¢ƒ**
- [ ] âœ… RuoYiæœåŠ¡å¯åŠ¨æˆåŠŸ
- [ ] âœ… Swaggeræ–‡æ¡£å¯è®¿é—®
- [ ] âœ… åŸºç¡€APIæ¥å£æµ‹è¯•é€šè¿‡
- [ ] âœ… è‡ªå®šä¹‰è®¾å¤‡æ¨¡å—åˆ›å»º
- [ ] âœ… ç³»ç»Ÿæ•´ä½“è¿è¡Œç¨³å®š

## ğŸš¨ å¸¸è§é—®é¢˜è§£å†³

### Dockerç›¸å…³é—®é¢˜
```powershell
# ç«¯å£è¢«å ç”¨
netstat -ano | findstr :3306
# æ‰¾åˆ°PIDåç»“æŸè¿›ç¨‹
taskkill /PID <PID> /F

# Dockerå®¹å™¨å¯åŠ¨å¤±è´¥
docker-compose down
docker system prune -f
docker-compose up -d

# å†…å­˜ä¸è¶³
docker system df
docker image prune -a
```

### Mavenç¼–è¯‘é—®é¢˜
```powershell
# æ¸…ç†Mavenç¼“å­˜
mvn dependency:purge-local-repository

# é‡æ–°ä¸‹è½½ä¾èµ–
mvn clean install -U

# è·³è¿‡æµ‹è¯•ç¼–è¯‘
mvn clean install -DskipTests -Dmaven.test.skip=true
```

### æ•°æ®åº“è¿æ¥é—®é¢˜
```sql
-- æ£€æŸ¥ç”¨æˆ·æƒé™
SELECT user, host FROM mysql.user;

-- åˆ›å»ºç”¨æˆ·å’Œæˆæƒ
CREATE USER 'mouse_user'@'%' IDENTIFIED BY 'mouse_pass';
GRANT ALL PRIVILEGES ON mouse_behavior.* TO 'mouse_user'@'%';
FLUSH PRIVILEGES;
```

---

**æ‰§è¡Œé¡ºåº**: æŒ‰æ­¥éª¤1-13ä¾æ¬¡æ‰§è¡Œ
**é¢„è®¡è€—æ—¶**: 4-6å°æ—¶
**æˆåŠŸæ ‡å‡†**: æ‰€æœ‰æ£€æŸ¥æ¸…å•é¡¹ç›®å®Œæˆï¼Œç³»ç»Ÿç¨³å®šè¿è¡Œ
**ä¸‹ä¸€æ­¥**: å¼€å§‹æ ¸å¿ƒä¸šåŠ¡æ¨¡å—çš„è¯¦ç»†å¼€å‘